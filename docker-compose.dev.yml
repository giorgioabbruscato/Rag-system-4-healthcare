version: '3.8'

# Development override for docker-compose.yml
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  api:
    build:
      context: .
      dockerfile: Dockerfile.api
      target: builder
    command: uvicorn api.main:app --host 0.0.0.0 --port 8000 --reload
    environment:
      - DEBUG=true
      - LOG_LEVEL=debug
    volumes:
      - ./api:/app/api:ro
      - ./src:/app/src:ro
      - ./scripts:/app/scripts:ro
      - ./data:/app/data

  streamlit:
    build:
      context: .
      dockerfile: Dockerfile.streamlit
      target: builder
    command: streamlit run app/streamlit_app.py --server.runOnSave=true
    environment:
      - DEBUG=true
    volumes:
      - ./app:/app/app:ro
      - ./src:/app/src:ro
